(function(){function b(){return b}function c(b,d){var e=c.resolve(b),f=c.modules[e];if(!f)throw Error('failed to require "'+b+'" from '+d);return f.exports||(f.exports={},f.call(f.exports,f,f.exports,c.relative(e),a)),f.exports}var a=this;c.modules={},c.resolve=function(a){var b=a,d=a+".js",e=a+"/index.js";return c.modules[d]&&d||c.modules[e]&&e||b},c.register=function(a,b){c.modules[a]=b},c.relative=function(a){return function(d){if("debug"==d)return b;if("."!=d.charAt(0))return c(d);var e=a.split("/"),f=d.split("/");e.pop();for(var g=0;g<f.length;g++){var h=f[g];".."==h?e.pop():"."!=h&&e.push(h)}return c(e.join("/"),a)}},c.register("engine.io-client.js",function(a,b,c,d){b.version="0.1.0",b.protocol=1,b.util=c("./util"),b.parser=c("./parser"),b.Socket=c("./socket"),b.EventEmitter=c("./event-emitter"),b.Transport=c("./transport"),b.transports=c("./transports")}),c.register("parser.js",function(a,b,c,d){var e=c("./util"),f=b.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5},g=e.keys(f),h={type:"error",data:"parser error"};b.encodePacket=function(a){var b=f[a.type];return undefined!==a.data&&(b+=a.data+""),""+b},b.decodePacket=function(a){var b=a.charAt(0);return Number(b)!=b||!g[b]?h:a.length>1?{type:g[b],data:a.substring(1)}:{type:g[b]}},b.encodePayload=function(a){if(!a.length)return"0:";var c="",d;for(var e=0,f=a.length;e<f;e++)d=b.encodePacket(a[e]),c+=d.length+":"+d;return c},b.decodePayload=function(a){if(a=="")return[h];var c=[],d="",e,f,g;for(var i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)d+=k;else{if(""==d||d!=(e=Number(d)))return[h];f=a.substr(i+1,e);if(d!=f.length)return[h];if(f.length){g=b.decodePacket(f);if(h.type==g.type&&h.data==g.data)return[h];c.push(g)}i+=e,d=""}}return d!=""?[h]:c}}),c.register("transports/flashsocket.js",function(a,b,c,d){function g(a){e.call(this,a),this.flashPath=a.flashPath}function h(){for(var a=0,b=navigator.plugins.length;a<b;a++)for(var c=0,d=navigator.plugins[a].length;c<d;c++)if(navigator.plugins[a][c]=="Shockwave Flash")return!0;return!1}function j(a,b){if(i[a])return b();var c=document.createElement("script"),d=!1;c.onload=c.onreadystatechange=function(){if(d||i[a])return;var e=c.readyState;if(!e||"loaded"==e||"complete"==e)c.onload=c.onreadystatechange=null,d=!0,i[a]=!0,b()},c.async=1,c.src=a;var e=document.getElementsByTagName("head")[0];e.insertBefore(c,e.firstChild)}function k(a,b){function c(d){if(!a[d])return b();j(a[d],function(){c(a[++d])})}c(0)}var e=c("./websocket"),f=c("../util");a.exports=g,f.inherits(g,e),g.prototype.name="flashsocket",g.prototype.doOpen=function(){function a(a){return function(){var a=Array.prototype.join.call(arguments," ")}}if(!h())return;WEB_SOCKET_LOGGER={log:a("debug"),error:a("error")},WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0;var b=[path+"web_socket.js"];"undefined"==typeof swfobject&&b.unshift(path+"swfobject.js"),k(b,function(){g.prototype.doOpen.call(self)})},g.prototype.doClose=function(){if(!this.socket)return;g.prototype.doClose.call(this)};var i={}}),c.register("transports/polling-jsonp.js",function(a,b,c,d){function j(){}function k(a){e.call(this,a),this.index=i++;var b=this;h.push(function(a){b.onData(a)}),this.query.j=h.length-1}var e=c("./polling"),f=c("../util");a.exports=k;var g=/\n/g,h=d.___eio=[],i=0;f.inherits(k,e),k.prototype.doOpen=function(){var a=this;f.defer(function(){e.prototype.doOpen.call(a)})},k.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),e.prototype.doClose.call(this)},k.prototype.doPoll=function(){var a=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),a.async=!0,a.src=this.uri();var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b),this.script=a,f.ua.gecko&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},k.prototype.doWrite=function(a,b){function i(){j(),b()}function j(){c.iframe&&c.form.removeChild(c.iframe);try{h=document.createElement('<iframe name="'+c.iframeId+'">')}catch(a){h=document.createElement("iframe"),h.name=c.iframeId}h.id=c.iframeId,c.form.appendChild(h),c.iframe=h}var c=this;if(!this.form){var d=document.createElement("form"),e=document.createElement("textarea"),f=this.iframeId="eio_iframe_"+this.index,h;d.className="socketio",d.style.position="absolute",d.style.top="-1000px",d.style.left="-1000px",d.target=f,d.method="POST",d.setAttribute("accept-charset","utf-8"),e.name="d",d.appendChild(e),document.body.appendChild(d),this.form=d,this.area=e}this.form.action=this.uri(),j(),this.area.value=a.replace(g,"\\n");try{this.form.submit()}catch(k){}this.iframe.attachEvent?h.onreadystatechange=function(){c.iframe.readyState=="complete"&&i()}:this.iframe.onload=i}}),c.register("transports/index.js",function(a,b,c,d){function j(a){var b=!1;return d.location&&(b=a.host!=d.location.hostname||d.location.port!=a.port),i.request(b)&&!a.forceJSONP?new e(a):new f(a)}var e=c("./polling-xhr"),f=c("./polling-jsonp"),g=c("./websocket"),h=c("./flashsocket"),i=c("../util");b.polling=j,b.websocket=g,b.flashsocket=h}),c.register("transports/websocket.js",function(a,b,c,d){function h(a){e.call(this,a)}function i(){return d.WebSocket||d.MozWebSocket}function j(){return!!i()}var e=c("../transport"),f=c("../parser"),g=c("../util");a.exports=h,g.inherits(h,e),h.prototype.name="websocket",h.prototype.doOpen=function(){if(!j())return;var a=this;this.socket=new(i())(this.uri()),this.socket.onopen=function(){a.onOpen()},this.socket.onclose=function(){a.onClose()},this.socket.onmessage=function(b){a.onData(b.data)},this.socket.onerror=function(b){a.onError("websocket error",b)}},h.prototype.write=function(a){for(var b=0,c=a.length;b<c;b++)this.socket.send(f.encodePacket(a[b]))},h.prototype.doClose=function(){this.socket.close()},h.prototype.uri=function(){var a=g.qs(this.query),b=this.secure?"wss":"ws",c="";return this.port&&("wss"==b&&this.port!=443||"ws"==b&&this.port!=80)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.host+c+this.path+a}}),c.register("transports/polling.js",function(a,b,c,d){function h(a){e.call(this,a),this.forceBust=!!a.forceBust}var e=c("../transport"),f=c("../util"),g=c("../parser");a.exports=h,f.inherits(h,e),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(a){function d(){c.readyState="paused",a()}var b=0,c=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(e++,this.once("poll",function(){--e||d()})),this.writable||(e++,this.once("drain",function(){--e||d()}))}else d()},h.prototype.poll=function(){this.polling=!0,this.doPoll()},h.prototype.onData=function(a){var b=g.decodePayload(a);for(var c=0,d=b.length;c<d;c++){"opening"==this.readyState&&this.onOpen();if("close"==b[c].type){this.onClose();return}this.onPacket(b[c])}this.polling=!1,this.emit("poll"),"open"==this.readyState&&this.poll()},h.prototype.doClose=function(){this.send([{type:"close"}])},h.prototype.write=function(a){var b=this;this.writable=!1,this.doWrite(g.encodePayload(a),function(){b.writable=!0,b.emit("drain")})},h.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";if(d.ActiveXObject||this.forceBust)a.t=+(new Date);return a=f.qs(a),this.port&&("https"==b&&this.port!=443||"http"==b&&this.port!=80)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.host+c+this.path+a}}),c.register("transports/polling-xhr.js",function(a,b,c,d){function h(){}function i(a){e.call(this,a),d.location&&(this.xd=a.host!=d.location.hostname||d.location.port!=a.port)}function j(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.async=!1!==a.async,this.data=undefined!=a.data?a.data:null,this.create()}var e=c("./polling"),f=c("../event-emitter"),g=c("../util");a.exports=i,a.exports.Request=j,g.inherits(i,e),i.prototype.doOpen=function(){var a=this;g.defer(function(){e.prototype.doOpen.call(a)})},i.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,new j(a)},i.prototype.doWrite=function(a,b){var c=this.request({method:"POST",data:a}),d=this;c.on("success",b),c.on("error",function(a){d.onError("xhr post error",a)}),this.sendXhr=c},i.prototype.doPoll=function(){var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},g.inherits(j,f),j.prototype.create=function(){var a=this.xhr=g.request(this.xd),b=this;a.open(this.method,this.uri,this.async);if("POST"==this.method)try{a.setRequestHeader?a.setRequestHeader("Content-type","text/plain;charset=UTF-8"):a.contentType="text/plain"}catch(c){}this.xd&&d.XDomainRequest&&a instanceof XDomainRequest?(a.onerror=function(a){b.onError(a)},a.onload=function(){b.onData(a.responseText)},a.onprogress=h):(a.withCredentials=!0,a.onreadystatechange=function(){var c;try{if(4!=a.readyState)return;200==a.status||1223==a.status?c=a.responseText:b.onError(a.status)}catch(d){b.onError(d)}undefined!==c&&b.onData(c)}),a.send(this.data),d.ActiveXObject&&(this.index=j.requestsCount++,j.requests[this.index]=this)},j.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},j.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},j.prototype.onError=function(a){this.emit("error",a),this.cleanup()},j.prototype.cleanup=function(){this.xhr.onreadystatechange=h,this.xhr.onload=this.xhr.onerror=h;try{this.xhr.abort()}catch(a){}d.ActiveXObject&&delete j.requests[this.index],this.xhr=null},j.prototype.abort=function(){this.cleanup()},d.ActiveXObject&&(j.requestsCount=0,j.requests={},d.attachEvent("onunload",function(){for(var a in j.requests)j.requests.hasOwnProperty(a)&&j.requests[a].abort()}))}),c.register("transport.js",function(a,b,c,d){function h(a){this.path=a.path,this.host=a.host,this.port=a.port,this.secure=a.secure,this.query=a.query,this.readyState=""}var e=c("./util"),f=c("./parser"),g=c("./event-emitter");a.exports=h,e.inherits(h,g),h.prototype.onError=function(a,b){var c=Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},h.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},h.prototype.send=function(a){if("open"!=this.readyState)throw Error("Transport not open");this.write(a)},h.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},h.prototype.onData=function(a){this.onPacket(f.decodePacket(a))},h.prototype.onPacket=function(a){this.emit("packet",a)},h.prototype.onClose=function(){this.readyState="closed",this.emit("close")}}),c.register("event-emitter.js",function(a,b,c,d){function e(){}function f(a){return"[object Array]"==Object.prototype.toString.call(a)}a.exports=e,e.prototype.on=function(a,b){return this.$events||(this.$events={}),this.$events[a]?f(this.$events[a])?this.$events[a].push(b):this.$events[a]=[this.$events[a],b]:this.$events[a]=b,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(a,b){function d(){c.removeListener(a,d),b.apply(this,arguments)}var c=this;return d.listener=b,this.on(a,d),this},e.prototype.removeListener=function(a,b){if(this.$events&&this.$events[a]){var c=this.$events[a];if(f(c)){var d=-1;for(var e=0,g=c.length;e<g;e++)if(c[e]===b||c[e].listener&&c[e].listener===b){d=e;break}if(d<0)return this;c.splice(d,1),c.length||delete this.$events[a]}else(c===b||c.listener&&c.listener===b)&&delete this.$events[a]}return this},e.prototype.removeAllListeners=function(a){return a===undefined?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},e.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),f(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},e.prototype.emit=function(a){if(!this.$events)return!1;var b=this.$events[a];if(!b)return!1;var c=Array.prototype.slice.call(arguments,1);if("function"==typeof b)b.apply(this,c);else{if(!f(b))return!1;var d=b.slice();for(var e=0,g=d.length;e<g;e++)d[e].apply(this,c)}return!0},e.prototype.addEventListener=e.prototype.on,e.prototype.removeEventListener=e.prototype.removeListener,e.prototype.dispatchEvent=e.prototype.emit}),c.register("socket.js",function(a,b,c,d){function i(a){if("string"==typeof a){var b=e.parseUri(a);a=arguments[1]||{},a.host=b.host,a.secure=b.scheme=="https"||b.scheme=="wss",a.port=b.port||(a.secure?443:80)}a=a||{},this.secure=a.secure||!1,this.host=a.host||a.hostname||"localhost",this.port=a.port||80,this.query=a.query||{},this.query.uid=k(),this.upgrade=!1!==a.upgrade,this.resource=a.resource||"default",this.path=(a.path||"/engine.io").replace(/\/$/,""),this.path+="/"+this.resource+"/",this.forceJSONP=!!a.forceJSONP,this.flashPath=a.flashPath||"",this.transports=a.transports||["polling","websocket","flashsocket"],this.readyState="",this.writeBuffer=[],this.open()}function j(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function k(){return(Math.random()+"").substr(5)+(Math.random()+"").substr(5)}var e=c("./util"),f=c("./transports"),g=c("debug")("engine-client:socket"),h=c("./event-emitter");a.exports=i,e.inherits(i,h),i.prototype.createTransport=function(a){g('creating transport "%s"',a);var b=j(this.query);b.transport=a,this.id&&(b.sid=this.id);var c=new f[a]({host:this.host,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,flashPath:this.flashPath});return c},i.prototype.open=function(){this.readyState="opening";var a=this.createTransport(this.transports[0]);a.open(),this.setTransport(a)},i.prototype.setTransport=function(a){var b=this;this.transport&&(g("clearing existing transport"),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.flush()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},i.prototype.probe=function(a){g('probing transport "%s"',a);var b=this.createTransport(a,{probe:1}),c=this;b.once("open",function(){g('probe transport "%s" opened',a),b.send([{type:"ping",data:"probe"}]),b.once("packet",function(d){if("pong"==d.type&&"probe"==d.data)g('probe transport "%s" pong',a),c.upgrading=!0,c.emit("upgrading",b),g('pausing current transport "%s"',c.transport.name),c.transport.pause(function(){if("closed"==c.readyState||"closing"==c.readyState)return;g("changing transport and sending upgrade packet"),c.emit("upgrade",b),c.setTransport(b),b.send([{type:"upgrade"}]),b=null,c.upgrading=!1,c.flush()});else{g('probe transport "%s" failed',a);var e=Error("probe error");e.transport=b.name,c.emit("error",e)}})}),b.open(),this.once("close",function(){b&&(g("socket closed prematurely - aborting probe"),b.close(),b=null)}),this.once("upgrading",function(a){b&&a.name!=b.name&&(g('"%s" works - aborting "%s"',a.name,b.name),b.close(),b=null)})},i.prototype.onOpen=function(){g("socket open"),this.readyState="open",this.emit("open"),this.onopen&&this.onopen.call(this),this.flush();if(this.upgrade&&this.transport.pause){g("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},i.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState){g('socket receive: type "%s", data "%s"',a.type,a.data);switch(a.type){case"open":this.onHandshake(e.parseJSON(a.data));break;case"ping":this.sendPacket("pong"),this.setPingTimeout();break;case"error":var b=Error("server error");b.code=a.data,this.emit("error",b);break;case"message":this.emit("message",a.data),this.onmessage&&this.onmessage.call(this,{data:a.data})}}else g('packet received with socket readyState "%s"',this.readyState)},i.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=a.upgrades,this.pingTimeout=a.pingTimeout,this.onOpen(),this.setPingTimeout()},i.prototype.setPingTimeout=function(){clearTimeout(this.pingTimeoutTimer);var a=this;this.pingTimeoutTimer=setTimeout(function(){a.onClose("ping timeout")},this.pingTimeout)},i.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(g("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.writeBuffer=[])},i.prototype.send=function(a){return this.sendPacket("message",a),this},i.prototype.sendPacket=function(a,b){var c={type:a,data:b};this.writeBuffer.push(c),this.flush()},i.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),g("socket closing - telling transport to close"),this.transport.close();return this},i.prototype.onError=function(a){this.emit("error",a),this.onClose("transport error",a)},i.prototype.onClose=function(a,b){"closed"!=this.readyState&&(g('socket close with reason: "%s"',a),this.readyState="closed",this.emit("close",a,b),this.onclose&&this.onclose.call(this))}}),c.register("util.js",function(a,b,c,d){var e=!1;b.inherits=function(b,c){function d(){}d.prototype=c.prototype,b.prototype=new d},b.keys=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b},b.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},b.load=function(a){if(d.document&&document.readyState==="complete"||e)return a();b.on(d,"load",a,!1)},"undefined"!=typeof window&&b.load(function(){e=!0}),b.defer=function(a){if(!b.ua.webkit||"undefined"!=typeof importScripts)return a();b.load(function(){setTimeout(a,100)})};var f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,j=/^\s+/,k=/\s+$/;b.parseJSON=function(a){if("string"!=typeof a||!a)return null;a=a.replace(j,"").replace(k,"");if(d.JSON&&JSON.parse)return JSON.parse(a);if(f.test(a.replace(g,"@").replace(h,"]").replace(i,"")))return Function("return "+a)()},b.ua={},b.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(b){return!1}return a.withCredentials!=undefined}(),b.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),b.ua.gecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent),b.request=function(c){if(c&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;try{if("undefined"!=typeof XMLHttpRequest&&(!c||b.ua.hasCORS))return new XMLHttpRequest}catch(d){}if(!c)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}};var l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,m=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.parseUri=function(a){var b=l.exec(a||""),c={},d=14;while(d--)c[m[d]]=b[d]||"";return c},b.qs=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=c+"="+encodeURIComponent(a[c]));return b}}),eio=c("engine.io-client")})(),function(){var a,b,c={}.hasOwnProperty,d=function(a,b){function e(){this.constructor=a}for(var d in b)c.call(b,d)&&(a[d]=b[d]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a},e=function(a,b){return function(){return a.apply(b,arguments)}},f=[].slice;window.AIOCookie=function(a,b,c){var d,e,f;d=function(){var a,b,c,d,e,f;b={},f=document.cookie.split(";");for(d=0,e=f.length;d<e;d++)a=f[d],c=a.split("="),b[c[0]]=c[1];return b},f=function(a,b,c){var d;d="",typeof c=="number"&&(d="; max-age="+c),typeof c=="string"&&(d="; expires="+c);if(typeof c=="object"?c.toGMTString:void 0)d="; expires="+c.toGMTString();document.cookie=""+escape(a)+"="+escape(b)+d},e=function(a){document.cookie=""+escape(a)+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/"};if(!a)return d();if(a&&b===null)return e(a);if(a&&!b)return d()[a];if(a&&b)return f(a,b,c)},a=function(a){function b(a){this.message=a.message,this.type=a.type,this.stack=a.stack}return d(b,a),b.name="ServerError",b.prototype.name="ServerError",b}(Error),b=function(){function b(a){var b,c,d,f,g;this.options=a!=null?a:{},this.addCookies=e(this.addCookies,this),this.handleClose=e(this.handleClose,this),this.handleMessage=e(this.handleMessage,this),this.handleError=e(this.handleError,this),this.handleOpen=e(this.handleOpen,this),(b=this.options).host==null&&(b.host=window.location.hostname),(c=this.options).port==null&&(c.port=window.location.port.length>0?parseInt(window.location.port):80),(d=this.options).secure==null&&(d.secure=window.location.protocol==="https:"),(f=this.options).path==null&&(f.path="/vein"),(g=this.options).forceBust==null&&(g.forceBust=!0),this.socket=new eio.Socket(this.options),this.socket.on("open",this.handleOpen),this.socket.on("error",this.handleError),this.socket.on("message",this.handleMessage),this.socket.on("close",this.handleClose);return}return b.name="Vein",b.prototype.connected=null,b.prototype.services=null,b.prototype._ready=[],b.prototype._close=[],b.prototype.callbacks={},b.prototype.subscribe={},b.prototype.cookie=AIOCookie,b.prototype.ready=function(a){this._ready.push(a),this.connected===!0&&a(this.services)},b.prototype.close=function(a){this._close.push(a),this.connected===!1&&a()},b.prototype.handleOpen=function(){var a=this;this.getSender("list")(function(b){var c,d,e,f,g,h,i,j;for(e=0,g=b.length;e<g;e++)d=b[e],a[d]=a.getSender(d),a.subscribe[d]=a.getSubscriber(d);a.services=b,a.connected=!0,i=a._ready,j=[];for(f=0,h=i.length;f<h;f++)c=i[f],j.push(c(b));return j})},b.prototype.handleError=function(){var a;a=1>arguments.length?[]:f.call(arguments,0),console.log("Error:",a)},b.prototype.handleMessage=function(b){var c,d,e,f,g,h,i,j,k,l,m;k=JSON.parse(b),g=k.id,h=k.service,c=k.args,e=k.error,d=k.cookies,Array.isArray(c)||(c=[c]);if(e!=null)throw new a(e);d!=null&&this.addCookies(d);if(g!=null&&this.callbacks[g])(l=this.callbacks)[g].apply(l,c);else if(h!=null&&this.subscribe[h]){m=this.subscribe[h].listeners;for(i=0,j=m.length;i<j;i++)f=m[i],f.apply(null,c)}},b.prototype.handleClose=function(){var a,b,c,d,e;a=1>arguments.length?[]:f.call(arguments,0),this.connected=!1,e=this._close;for(c=0,d=e.length;c<d;c++)b=e[c],b.apply(null,a)},b.prototype.addCookies=function(a){var b,c,d;b=this.cookie();for(c in a)d=a[c],b[c]!==d&&this.cookie(c,d)},b.prototype.getSubscriber=function(a){var b,c=this;return b=function(b){c.subscribe[a].listeners.push(b)},b.listeners=[],b},b.prototype.getSender=function(a){var b=this;return function(){var c,d,e,g,h;c=2>arguments.length?(h=0,[]):f.call(arguments,0,h=arguments.length-1),d=arguments[h++],e=b.getId(),b.callbacks[e]=d,g=JSON.stringify({id:e,service:a,args:c,cookies:b.cookie()}),b.socket.send(g)}},b.prototype.getId=function(){var a;return a=function(){return((1+Math.random())*268435456|0).toString(16)},a()+a()+a()},b}(),typeof define=="function"&&define("Vein",function(){return b}),window.Vein=b}.call(this);